{
  "hash": "c7f27a19239529d5f38c0fa84d2b4c04",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Cardiovascular Disease\"\nauthor: \"Soham Shankar Mandal\"\ndate: \"2025-10-19\"\nformat: html\neditor: visual\ncategories: [code]\n---\n\n![](images/clipboard-2842977859.png)\n\n# Cardiovascular Disease\n\nEXPERIMENT OBJECTIVE:\n\nThis study seeks to analyze the demographic, behavioral, and socioeconomic factors influencing cardiovascular disease prevalence among adults in Scotland, specifically examining patterns across age groups, sex categories, smoking behaviors, social class strata, and area deprivation levels.\n\n## 1. *Setting up R Packages*\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SETUP CHUNK- LIBRARIES\n#| label: setup\n#| echo: false\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggformula) \nlibrary(skimr) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'skimr'\n\nThe following object is masked from 'package:mosaic':\n\n    n_missing\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(janitor) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'janitor'\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(naniar) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'naniar'\n\nThe following object is masked from 'package:skimr':\n\n    n_complete\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(visdat)\nlibrary(tinytable) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'tinytable'\n\nThe following object is masked from 'package:ggplot2':\n\n    theme_void\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(DT) \nlibrary(crosstable) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'crosstable'\n\nThe following object is masked from 'package:purrr':\n\n    compact\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(RColorBrewer)\nlibrary(naniar)\nlibrary(tidyr)\nlibrary(dplyr)\nlibrary(CardioDataSets)\nlibrary(ggplot2)\n```\n:::\n\n\n## 2. *Loading Data*\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(package = \"CardioDataSets\")\n```\n:::\n\n\n## 3. *Examining the Dataset*\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndplyr::glimpse(scottish_CVD_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 8,804\nColumns: 8\n$ age      <int> 50, 71, 55, 61, 32, 26, 68, 32, 20, 37, 47, 37, 70, 34, 49, 4…\n$ sex      <fct> female, female, female, female, female, female, female, male,…\n$ sc       <fct> 3, 45, 45, 3, 12, 3, 45, 12, 45, 12, 12, 45, 12, 3, 3, 12, 3,…\n$ cvddef   <int> 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1…\n$ carstair <dbl> -2.45, -2.45, -2.45, -2.45, -2.45, -2.45, -2.45, -2.45, -2.45…\n$ smoke    <fct> nevr, nevr, mod, ex, ex, mod, hvy, nevr, ex, ex, nevr, ex, ne…\n$ id       <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ area     <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskimr::skim(scottish_CVD_df)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |                |\n|:------------------------|:---------------|\n|Name                     |scottish_CVD_df |\n|Number of rows           |8804            |\n|Number of columns        |8               |\n|_______________________  |                |\n|Column type frequency:   |                |\n|factor                   |3               |\n|numeric                  |5               |\n|________________________ |                |\n|Group variables          |None            |\n\n\n**Variable type: factor**\n\n|skim_variable | n_missing| complete_rate|ordered | n_unique|top_counts                                |\n|:-------------|---------:|-------------:|:-------|--------:|:-----------------------------------------|\n|sex           |         0|             1|FALSE   |        2|fem: 4987, mal: 3817                      |\n|sc            |         0|             1|FALSE   |        3|3: 3686, 45: 2697, 12: 2421               |\n|smoke         |         0|             1|FALSE   |        5|nev: 3573, ex: 2151, mod: 1270, hvy: 1233 |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|      sd|    p0|     p25|     p50|     p75|    p100|hist  |\n|:-------------|---------:|-------------:|-------:|-------:|-----:|-------:|-------:|-------:|-------:|:-----|\n|age           |         0|             1|   46.21|   15.52| 18.00|   33.00|   45.00|   60.00|   74.00|▆▇▆▆▆ |\n|cvddef        |         0|             1|    0.27|    0.45|  0.00|    0.00|    0.00|    1.00|    1.00|▇▁▁▁▃ |\n|carstair      |         0|             1|   -0.20|    3.27| -6.23|   -2.46|   -0.68|    1.48|   12.53|▅▇▃▁▁ |\n|id            |         0|             1| 4421.93| 2552.58|  1.00| 2212.75| 4420.50| 6633.25| 8842.00|▇▇▇▇▇ |\n|area          |         0|             1|  162.75|   91.19|  1.00|   84.00|  165.00|  244.25|  312.00|▆▆▇▇▇ |\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscottish_CVD_df_modified <- scottish_CVD_df %>%\n   tidyr::drop_na()\n\n\nglimpse(scottish_CVD_df_modified)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 8,804\nColumns: 8\n$ age      <int> 50, 71, 55, 61, 32, 26, 68, 32, 20, 37, 47, 37, 70, 34, 49, 4…\n$ sex      <fct> female, female, female, female, female, female, female, male,…\n$ sc       <fct> 3, 45, 45, 3, 12, 3, 45, 12, 45, 12, 12, 45, 12, 3, 3, 12, 3,…\n$ cvddef   <int> 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1…\n$ carstair <dbl> -2.45, -2.45, -2.45, -2.45, -2.45, -2.45, -2.45, -2.45, -2.45…\n$ smoke    <fct> nevr, nevr, mod, ex, ex, mod, hvy, nevr, ex, ex, nevr, ex, ne…\n$ id       <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…\n$ area     <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n```\n\n\n:::\n:::\n\n\n## 4. *Data Dictionary*\n\n## *Quantitative Data*\n\n1.  age (dbl): Respondent’s age in years\n2.  cvddef (dbl): Doctor-diagnosed cardiovascular disease status (0 = no, 1 = yes)\n3.  carstair (dbl): Carstairs deprivation score representing socioeconomic disadvantage\n4.  id (dbl): Respondent identification number\n5.  area (dbl): Geographic area code\n\n## *Qualitative Data*\n\n1.sex (fct): Respondent’s sex (factor with 2 levels: male/female) 2.sc (fct): Social class (factor with 3 levels) 3. smoke (fct): Smoking status (factor with 5 levels)\n\n## 5. *Graphs*\n\n## 1. Among non-smokers, does cardiovascular disease risk increase with age, and does this age-related increase differ between men and women?\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscottish_CVD_nonsmokers <- scottish_CVD_df_modified %>%\n  filter(smoke == \"nevr\") %>%\n  mutate(age_group = cut(age, \n                         breaks = c(18, 30, 40, 50, 60, 70, 79),\n                         labels = c(\"18-29\", \"30-39\", \"40-49\", \"50-59\", \"60-69\", \"70-79\"),\n                         right = FALSE))\n\ncvd_proportions_nonsmokers <- scottish_CVD_nonsmokers %>%\n  group_by(age_group, sex) %>%\n  summarise(proportion_cvd = mean(cvddef, na.rm = TRUE),\n            .groups = \"drop\")\n\ngf_col(proportion_cvd ~ age_group, \n       data = cvd_proportions_nonsmokers,\n       fill = ~sex,\n       position = \"dodge\") %>%\n  gf_labs(title = \"Risk of Cardiovascular Disease (CVD) by Age and Sex (Non-Smokers Only)\",\n          x = \"Age Group\",\n          y = \"Proportion with CVD\",\n          fill = \"Sex\") \n```\n\n::: {.cell-output-display}\n![](scottish_cvd_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## 2. Among smokers, does cardiovascular disease risk increase with age, and does this age-related increase differ between men and women?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscottish_CVD_smokers <- scottish_CVD_df_modified %>%\n  filter(smoke != \"nevr\") %>%\n  mutate(age_group = cut(age, \n                         breaks = c(18, 30, 40, 50, 60, 70, 79),\n                         labels = c(\"18-29\", \"30-39\", \"40-49\", \"50-59\", \"60-69\", \"70-79\"),\n                         right = FALSE))\n\ncvd_proportions_smokers <- scottish_CVD_smokers %>%\n  group_by(age_group, sex) %>%\n  summarise(proportion_cvd = mean(cvddef, na.rm = TRUE),\n            .groups = \"drop\")\n\ngf_col(proportion_cvd ~ age_group, \n       data = cvd_proportions_smokers,\n       fill = ~sex,\n       position = \"dodge\") %>%\n  gf_labs(title = \"Risk of Cardiovascular Disease (CVD) by Age and Sex (Smokers Only)\",\n          x = \"Age Group\",\n          y = \"Proportion with CVD\",\n          fill = \"Sex\")\n```\n\n::: {.cell-output-display}\n![](scottish_cvd_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## 3. How do smoking status and age interact to affect cardiovascular disease risk, and are these patterns different for men and women?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscottish_CVD_mosaic <- scottish_CVD_df_modified %>%\n  mutate(\n    smoking_status = ifelse(smoke == \"nevr\", \"Non-Smoker\", \"Smoker\"),\n    age_group = cut(age, \n                    breaks = c(18, 30, 40, 50, 60, 70, 79),\n                    labels = c(\"18-29\", \"30-39\", \"40-49\", \"50-59\", \"60-69\", \"70-79\"),\n                    right = FALSE),\n    cvd_status = factor(cvddef, \n                       levels = c(0, 1),\n                       labels = c(\"No\", \"Yes\"))\n  )\n\n\nmosaic_table <- xtabs(~ smoking_status + age_group + cvd_status + sex, \n                       data = scottish_CVD_mosaic)\n\nvcd::mosaic(~ smoking_status + age_group + cvd_status | sex,\n            data = mosaic_table,\n            main = \"Smoking Status, Age Group, and CVD by Sex\",\n            shade = TRUE,\n            legend = TRUE,\n            labeling_args = list(\n              set_varnames = c(\n                smoking_status = \"Smoking Status\",\n                age_group = \"Age Group\",\n                cvd_status = \"CVD Status (0=No, 1=Yes)\",\n                sex = \"Sex\"\n              )\n            ))\n```\n\n::: {.cell-output-display}\n![](scottish_cvd_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## 4. Are people who smoke more likely to have cardiovascular disease, and is this effect different by social class?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscottish_CVD_mosaic2 <- scottish_CVD_df_modified %>%\n  mutate(\n    smoking_category = case_when(\n      smoke == \"nevr\" ~ \"Never\",\n      smoke == \"ex\" ~ \"Former\",\n      smoke %in% c(\"mod\", \"hvy\") ~ \"Current\",\n      TRUE ~ as.character(smoke)\n    ),\n    smoking_category = factor(smoking_category, \n                             levels = c(\"Never\", \"Former\", \"Current\")),\n    cvd_status = factor(cvddef, \n                       levels = c(0, 1),\n                       labels = c(\"No\", \"Yes\"))\n  )\n\nmosaic_table2 <- xtabs(~ smoking_category + sc + cvd_status, \n                       data = scottish_CVD_mosaic2)\n\nvcd::mosaic(~ smoking_category + sc + cvd_status,\n            data = mosaic_table2,\n            main = \"Smoking Status, Social Class, and CVD\",\n            shade = TRUE,\n            legend = TRUE,\n            labeling_args = list(\n              set_varnames = c(\n                smoking_category = \"Smoking Status\",\n                sc = \"Social Class\",\n                cvd_status = \"CVD Status\"\n              )\n            ))\n```\n\n::: {.cell-output-display}\n![](scottish_cvd_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## 5. Does Risk of CVD Increase with Age and Deprivation?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_point(age ~ carstair, \n         data = scottish_CVD_df_modified,\n         color = ~factor(cvddef, labels = c(\"No CVD\", \"CVD\")),\n         alpha = 0.4,\n         size = 2) %>%\n  gf_labs(title = \"Does Risk of CVD Increase with Age and Deprivation?\",\n          x = \"Carstairs Deprivation Score (Higher = More Deprived)\",\n          y = \"Age (years)\",\n          color = \"CVD Status\")\n```\n\n::: {.cell-output-display}\n![](scottish_cvd_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n## 6. Do smokers live in more deprived areas than non-smokers, and does this relationship differ between men and women?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscottish_CVD_smoking <- scottish_CVD_df_modified %>%\n  filter(!is.na(smoke), !is.na(carstair), !is.na(sex)) %>%\n  mutate(\n    smoking_category = case_when(\n      smoke == \"nevr\" ~ \"Never\",\n      smoke == \"ex\" ~ \"Former\",\n      smoke == \"mod\" ~ \"Moderate\",\n      smoke == \"hvy\" ~ \"Heavy\",\n      TRUE ~ as.character(smoke)\n    ),\n    smoking_category = factor(smoking_category, \n                             levels = c(\"Never\", \"Former\", \"Moderate\", \"Heavy\"))\n  ) %>%\n  filter(!is.na(smoking_category))\n\nggplot(scottish_CVD_smoking, aes(x = smoking_category, y = carstair)) +\n  geom_boxplot() +\n  facet_wrap(~ sex) +\n  labs(title = \"Deprivation Level by Smoking Status and Sex\",\n       x = \"Smoking Status\",\n       y = \"Carstairs Deprivation Score\") +\n  theme_minimal() \n```\n\n::: {.cell-output-display}\n![](scottish_cvd_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## 6. *Summary*\n\n## Graph 1: CVD Risk by Age and Sex (Non-Smokers Only)\n\n## Key Findings:\n\n1.  CVD risk increases dramatically with age even among non-smokers, rising from \\~8% in the 18-29 age group to over 50% in the 70-79 age group.\n\n2.  There's a clear age-related progression, with the steepest increase occurring after age 50.\n\n## Unexpected Discovery:\n\nIn the oldest age group (70-79), females actually have higher CVD prevalence than males (\\~55% vs \\~42%), which contradicts the typical pattern seen in younger age groups where males have higher risk. This reversal suggests that biological aging may affect women's cardiovascular health more severely in later life, possibly related to post-menopausal changes.\n\n## Graph 2: CVD Risk by Age and Sex (Smokers Only)\n\n## Key Findings:\n\n1.  Smokers show substantially higher CVD rates than non-smokers across all age groups, with prevalence reaching \\~65% for males aged 70-79.\n\n2.  The age-CVD gradient is steeper among smokers, indicating that smoking accelerates age-related cardiovascular damage.\n\n## Unexpected Discovery:\n\nThe sex difference pattern is inconsistent across age groups, in the 40-49 age group, males have notably higher CVD (\\~24% vs \\~20%), but in the 50-59 group, females catch up significantly (\\~42% vs \\~35%). This suggests that smoking may have more pronounced effects on women's cardiovascular health in middle age, possibly due to interactions with hormonal changes.\n\n## Graph 3: Smoking Status, Age Group, and CVD by Sex (Mosaic Plot)\n\n## Key Findings:\n\n1.  The mosaic plot confirms strong associations between smoking, age, and CVD, with significant Pearson residuals (p \\< 2.22e-16).\n\n2.  Blue-shaded tiles (positive residuals) indicate combinations that occur more frequently than expected, particularly CVD cases among older smokers.\n\n## Unexpected Discovery:\n\nAmong young male non-smokers (18-29 age group), there's a strong blue shading for CVD=No, indicating this group has even fewer CVD cases than would be expected by chance. Conversely, there's notable red shading (negative residuals) for older female smokers without CVD, suggesting that smoking has particularly strong effects on older women's cardiovascular health, fewer escape CVD than statistical models would predict.\n\n## Graph 4: Smoking Status, Social Class, and CVD (Mosaic Plot)\n\n## Key Findings:\n\n1.  Social class shows strong associations with both smoking behavior and CVD risk (p \\< 2.22e-16).\n\n2.  Current smokers in lower social classes (4-5) show strong positive residuals (blue shading) for CVD=Yes, indicating clustering of multiple risk factors.\n\n## Unexpected Discovery:\n\nSocial class 1-2 (highest class) never-smokers show strong blue shading for CVD=No, they have even lower CVD rates than expected. However, the most striking finding is that former smokers in social class 4-5 show strong blue residuals for CVD=Yes, suggesting that even after quitting smoking, people in lower social classes continue to have elevated CVD risk. This indicates that smoking cessation alone may not eliminate the cardiovascular burden in socioeconomically disadvantaged populations, likely due to other persistent risk factors (diet, stress, healthcare access, environmental exposures).\n\n## Graph 5: Age vs Deprivation Score (Scatterplot)\n\n## Key Findings:\n\n1.  CVD cases (blue/teal points) are distributed across all deprivation levels and ages, but show higher concentration in older age groups.\n\n2.  The scatterplot reveals the full distribution of individuals rather than aggregated proportions.\n\n## Unexpected Discovery:\n\nThere is no strong visible linear relationship between age and deprivation score, the points are fairly evenly distributed across the Carstairs scale at all ages. This is unexpected because it suggests that area deprivation and individual age are independent risk factors rather than correlated variables. People of all ages live in both deprived and affluent areas. Additionally, CVD cases appear across the entire deprivation spectrum, though visual inspection suggests slightly higher density in more deprived areas (positive Carstairs scores). This reinforces that while deprivation increases CVD risk at the population level, substantial numbers of people in affluent areas still develop CVD due to other risk factors.\n\n## Graph 3: Deprivation Level by Smoking Status and Sex (Box Plot)\n\n## Key Findings:\n\n1.  Both moderate and heavy smokers show higher median Carstairs scores (indicating more deprivation) compared to never-smokers and former smokers​\n\n2.  The pattern is consistent across both sexes, confirming the social gradient in smoking behavior\n\n## Unexpected Discovery:\n\nFormer smokers show very similar deprivation distributions to never-smokers, rather than intermediate levels between never-smokers and current smokers. This suggests that smoking cessation may be more common among those in less deprived areas, or that people who successfully quit smoking may have different socioeconomic profiles than those who continue smoking. Additionally, the wide distribution and numerous outliers indicate substantial individual variation, many people in highly deprived areas don't smoke, and some in affluent areas do.\n",
    "supporting": [
      "scottish_cvd_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}